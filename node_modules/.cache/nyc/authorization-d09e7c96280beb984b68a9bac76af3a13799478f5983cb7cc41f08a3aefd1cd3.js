function cov_1x54e9giqx(){var path="/Users/ningjia/Desktop/CSDS393/server/middleware/authorization.js";var hash="0a147af10aab7f20821a4d8a2c2d542ee6d40298";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ningjia/Desktop/CSDS393/server/middleware/authorization.js",statementMap:{"0":{start:{line:2,column:12},end:{line:2,column:35}},"1":{start:{line:3,column:0},end:{line:3,column:27}},"2":{start:{line:6,column:0},end:{line:25,column:2}},"3":{start:{line:8,column:18},end:{line:8,column:37}},"4":{start:{line:11,column:4},end:{line:13,column:5}},"5":{start:{line:12,column:8},end:{line:12,column:70}},"6":{start:{line:16,column:4},end:{line:23,column:5}},"7":{start:{line:18,column:23},end:{line:18,column:63}},"8":{start:{line:19,column:8},end:{line:19,column:31}},"9":{start:{line:20,column:8},end:{line:20,column:15}},"10":{start:{line:22,column:8},end:{line:22,column:61}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:42},end:{line:25,column:1}},line:6}},branchMap:{"0":{loc:{start:{line:11,column:4},end:{line:13,column:5}},type:"if",locations:[{start:{line:11,column:4},end:{line:13,column:5}},{start:{line:11,column:4},end:{line:13,column:5}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},f:{"0":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"0a147af10aab7f20821a4d8a2c2d542ee6d40298"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1x54e9giqx=function(){return actualCoverage;};}return actualCoverage;}cov_1x54e9giqx();const jwt=(cov_1x54e9giqx().s[0]++,require("jsonwebtoken"));cov_1x54e9giqx().s[1]++;require("dotenv").config();cov_1x54e9giqx().s[2]++;module.exports=function(req,res,next){cov_1x54e9giqx().f[0]++;// Get token from header
const token=(cov_1x54e9giqx().s[3]++,req.header("token"));// check if there isn't token
cov_1x54e9giqx().s[4]++;if(!token){cov_1x54e9giqx().b[0][0]++;cov_1x54e9giqx().s[5]++;return res.status(403).json({msg:"Authorization denied."});}else{cov_1x54e9giqx().b[0][1]++;}// verify token
cov_1x54e9giqx().s[6]++;try{//it is going to give use the user id (user:{id: user.id})
const verify=(cov_1x54e9giqx().s[7]++,jwt.verify(token,process.env.jwtSecret));cov_1x54e9giqx().s[8]++;req.user=verify.user;cov_1x54e9giqx().s[9]++;next();}catch(err){cov_1x54e9giqx().s[10]++;res.status(401).json({msg:"Token is not valid."});}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImNvbmZpZyIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXIiLCJzdGF0dXMiLCJqc29uIiwibXNnIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsImp3dFNlY3JldCIsInVzZXIiLCJlcnIiXSwibWFwcGluZ3MiOiJtbURBZVk7MkZBZFosS0FBTUEsQ0FBQUEsR0FBRywwQkFBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBVixDQUFULEMsd0JBQ0FBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JDLE1BQWxCLEcsd0JBR0FDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixTQUFTQyxHQUFULENBQWNDLEdBQWQsQ0FBbUJDLElBQW5CLENBQXlCLHlCQUN0QztBQUNBLEtBQU1DLENBQUFBLEtBQUssMEJBQUdILEdBQUcsQ0FBQ0ksTUFBSixDQUFXLE9BQVgsQ0FBSCxDQUFYLENBRUE7QUFKc0Msd0JBS3RDLEdBQUksQ0FBQ0QsS0FBTCxDQUFZLG9EQUNSLE1BQU9GLENBQUFBLEdBQUcsQ0FBQ0ksTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLENBQUVDLEdBQUcsQ0FBRSx1QkFBUCxDQUFyQixDQUFQLENBQ0gsQ0FGRCxpQ0FJQTtBQVRzQyx3QkFVdEMsR0FBSSxDQUNBO0FBQ0EsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBR2IsR0FBRyxDQUFDYSxNQUFKLENBQVdMLEtBQVgsQ0FBa0JNLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxTQUE5QixDQUFILENBQVosQ0FGQSx3QkFHQVgsR0FBRyxDQUFDWSxJQUFKLENBQVdKLE1BQU0sQ0FBQ0ksSUFBbEIsQ0FIQSx3QkFJQVYsSUFBSSxHQUNQLENBQUMsTUFBT1csR0FBUCxDQUFZLDBCQUNWWixHQUFHLENBQUNJLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixDQUFFQyxHQUFHLENBQUUscUJBQVAsQ0FBckIsRUFDSCxDQUVKLENBbkJEIiwic291cmNlc0NvbnRlbnQiOlsiXG5jb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xucmVxdWlyZShcImRvdGVudlwiKS5jb25maWcoKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgLy8gR2V0IHRva2VuIGZyb20gaGVhZGVyXG4gICAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVyKFwidG9rZW5cIik7XG5cbiAgICAvLyBjaGVjayBpZiB0aGVyZSBpc24ndCB0b2tlblxuICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgbXNnOiBcIkF1dGhvcml6YXRpb24gZGVuaWVkLlwiIH0pO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSB0b2tlblxuICAgIHRyeSB7XG4gICAgICAgIC8vaXQgaXMgZ29pbmcgdG8gZ2l2ZSB1c2UgdGhlIHVzZXIgaWQgKHVzZXI6e2lkOiB1c2VyLmlkfSlcbiAgICAgICAgY29uc3QgdmVyaWZ5ID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuand0U2VjcmV0KTtcbiAgICAgICAgcmVxLnVzZXIgPSB2ZXJpZnkudXNlcjtcbiAgICAgICAgbmV4dCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1zZzogXCJUb2tlbiBpcyBub3QgdmFsaWQuXCIgfSk7XG4gICAgfVxuXG59OyJdfQ==